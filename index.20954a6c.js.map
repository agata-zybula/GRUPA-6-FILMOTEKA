{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,S,aAGA,MAAMC,EAAUC,SAASC,cAAc,6BACjCC,EAAiBF,SAASC,cAAc,8BACxCE,EAAYH,SAASC,cAAc,+BACnCG,EAAYJ,SAASC,cAAc,kBAGzC,IAAII,EAAO,EAEXF,EAAUG,MAAMC,WAAa,SAE7B,MAAMC,EAAkBC,UACtB,IACE,MAAMC,EAAqB,4CAIrBC,SAHeC,EAAAC,QAAMC,IACzB,GAAGJ,oDAA+CX,EAAQgB,cAAcV,qBAEpDW,KAAKC,QAE3B,aADM,EAAApB,EAAAqB,aACCP,CAGT,CAFE,MAAOQ,GACPC,QAAQD,MAAMA,EAChB,GAGIE,EAAwBV,GACLA,EAAOW,QAAOC,GACnCA,EAAMC,MAAMC,cAAcC,SAAS3B,EAAQgB,MAAMU,iBAIhDE,KAAIJ,IACH,MAAMK,EAAaL,EAAMM,UACtBC,MAAM,EAAG,GACTH,KAAII,GAAWlC,EAAAmC,UAAUD,KACzBE,KAAK,MACR,MAAO,6FACLV,EAAMW,+BACYX,EAAMC,yBAAyBD,EAAMY,wHAGtBZ,EAAMC,uDACNI,qDACEL,EAAMa,aAAaN,MAAM,EAAG,iEAE/BO,KAAKC,MAA2B,GAArBf,EAAMgB,cAAqB,gCAErE,IAEJN,KAAK,IAOJO,EAAe/B,UAHnBL,EAAUqC,UAAY,GAKtBpC,EAAO,EACP,MAAMM,QAAeH,IACC,IAAlBG,EAAO+B,OACTvC,EAAUG,MAAMC,WAAa,WAE7BJ,EAAUG,MAAMC,WAAa,SAC7BH,EAAUqC,UAAYpB,EAAsBV,GAC9C,EAUFT,EAAeyC,iBAAiB,SAASC,IACvCA,EAAMC,iBACNL,GAAA,IAGFzC,EAAQ4C,iBAAiB,YAAYC,IACjB,UAAdA,EAAME,MACRF,EAAMC,iBACNL,IACF,IAUFO,OAAOJ,iBAAiB,UAPH,KACnB,MAAMK,UAAEA,EAASC,aAAEA,EAAYC,aAAEA,GAAiBlD,SAASmD,gBACvDH,EAAYC,GAAgBC,GApBhC1C,IAAkB4C,MAAKzC,IACrBN,GAAQ,EACRD,EAAUiD,mBAAmB,YAAahC,EAAsBV,GAAA,GAmBhE","sources":["src/js/header-home.js"],"sourcesContent":["import { genreList, getGenres } from './fetch-genres';\nimport axios from 'axios';\n\nconst inputEl = document.querySelector('.header-search-bar__input');\nconst searchButtonEl = document.querySelector('.header-search-bar__button');\nconst warningEl = document.querySelector('.header-search-bar__warning');\nconst galleryEl = document.querySelector('.cards-wrapper');\n\nconst API_key = 'dbea77d3eb5b3622b027f73f6a5032fe';\nlet page = 1;\n\nwarningEl.style.visibility = 'hidden';\n\nconst getMoviesSearch = async () => {\n  try {\n    const searchMovieAPI_URL = 'https://api.themoviedb.org/3/search/movie';\n    const result = await axios.get(\n      `${searchMovieAPI_URL}?api_key=${API_key}&query=${inputEl.value}&page=${page}&language=en-US`,\n    );\n    const movies = result.data.results;\n    await getGenres();\n    return movies;\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nconst createMovieCardSearch = movies => {\n  const filteredMovies = movies.filter(movie =>\n    movie.title.toLowerCase().includes(inputEl.value.toLowerCase()),\n  );\n\n  return filteredMovies\n    .map(movie => {\n      const genreNames = movie.genre_ids\n        .slice(0, 3)\n        .map(genreId => genreList[genreId])\n        .join(', ');\n      return `<div id=\"card\" class=\"card\"><img class=\"card__poster\" src='https://image.tmdb.org/t/p/w500${\n        movie.poster_path\n      }' alt='Poster of ${movie.title} movie' data-id=\"${movie.id}\"></a>\n    <div class=\"card__info\">\n      <div class=\"card__quick-info\">\n        <div class=\"card__movie-title\">${movie.title}</div>\n        <div class=\"card__movie-genre\">${genreNames}</div>\n        <div class=\"card__movie-release\">${movie.release_date.slice(0, 4)}</div>\n      </div>\n      <div class=\"card__movie-rating\">${Math.round(movie.vote_average * 10) / 10}</div>\n    </div>\n  </div>`;\n    })\n    .join('');\n};\n\nconst clearGallery = () => {\n  galleryEl.innerHTML = '';\n};\n\nconst searchMovies = async () => {\n  clearGallery();\n  page = 1;\n  const movies = await getMoviesSearch();\n  if (movies.length === 0) {\n    warningEl.style.visibility = 'visible';\n  } else {\n    warningEl.style.visibility = 'hidden';\n    galleryEl.innerHTML = createMovieCardSearch(movies);\n  }\n};\n\nconst loadMoreMovies = () => {\n  getMoviesSearch().then(movies => {\n    page += 1;\n    galleryEl.insertAdjacentHTML('beforeend', createMovieCardSearch(movies));\n  });\n};\n\nsearchButtonEl.addEventListener('click', event => {\n  event.preventDefault();\n  searchMovies();\n});\n\ninputEl.addEventListener('keypress', event => {\n  if (event.key === 'Enter') {\n    event.preventDefault();\n    searchMovies();\n  }\n});\n\nconst handleScroll = () => {\n  const { scrollTop, clientHeight, scrollHeight } = document.documentElement;\n  if (scrollTop + clientHeight >= scrollHeight) {\n    loadMoreMovies();\n  }\n};\n\nwindow.addEventListener('scroll', handleScroll);\n"],"names":["$knVcn","parcelRequire","$9a5745b8d2152452$var$inputEl","document","querySelector","$9a5745b8d2152452$var$searchButtonEl","$9a5745b8d2152452$var$warningEl","$9a5745b8d2152452$var$galleryEl","$9a5745b8d2152452$var$page","style","visibility","$9a5745b8d2152452$var$getMoviesSearch","async","searchMovieAPI_URL","movies","$hGVxz","default","get","value","data","results","getGenres","error","console","$9a5745b8d2152452$var$createMovieCardSearch","filter","movie","title","toLowerCase","includes","map","genreNames","genre_ids","slice","genreId","genreList","join","poster_path","id","release_date","Math","round","vote_average","$9a5745b8d2152452$var$searchMovies","innerHTML","length","addEventListener","event","preventDefault","key","window","scrollTop","clientHeight","scrollHeight","documentElement","then","insertAdjacentHTML"],"version":3,"file":"index.20954a6c.js.map"}